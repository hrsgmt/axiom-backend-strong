<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
</head>
<body>
  <script src="js/guard.js"></script>

  <h2>Dashboard</h2>
  <pre id="user"></pre>

  <button onclick="logout()">Logout</button>

  <script>
    async function loadMe() {
      const token = localStorage.getItem("token");
      const res = await fetch("http://127.0.0.1:4000/api/me", {
        headers: { Authorization: "Bearer " + token }
      });
      const data = await res.json();
      document.getElementById("user").textContent =
        JSON.stringify(data, null, 2);
    }

    function logout() {
      localStorage.removeItem("token");
      location.href = "/";
    }

    loadMe();
  </script>
</body>
</html>
